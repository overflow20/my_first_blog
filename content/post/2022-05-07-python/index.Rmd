---
title: Pythonæ¯æ—¥éšå¿ƒè®°
author: zyy
date: '2022-05-07'
slug: python
categories: []
tags: []
---

ä¹¦ç±åˆ—è¡¨(æ›´æ–°ä¸­)ï¼š

- [åˆ©ç”¨ Python è¿›è¡Œæ•°æ®åˆ†æ Â· ç¬¬ 2 ç‰ˆ](https://www.bookstack.cn/read/pyda-2e-zh/README.md),ç¬¬3ç‰ˆå·²äº2022å¹´æ›´æ–°ï¼Œ[ç¬¬3ç‰ˆç½‘å€](https://wesmckinney.com/book/)

## æ—¶é—´


## 5.30
- pivotä¸crosstab

## 5.29
- 10.2 æ•°æ®èšåˆ
- 10.3 apply

## 5.28
- 10.1 æ•°æ®åˆ†ç»„

## 5.26
- ç”»å›¾
è¦æ”¹å˜xè½´åˆ»åº¦ï¼Œæœ€ç®€å•çš„åŠæ³•æ˜¯ä½¿ç”¨`set_xticks`å’Œ`set_xticklabels`;
`ax.legend()`;
`ax.text()`

## 5.21
- `pivot`

## 5.20
çˆ±è€çˆ¸ï¼

- `merge`
- `concat`

## 5.19
ä»Šå¤©çš„è£™å­å¥½éªšå•Šemm

- å±‚æ¬¡åŒ–ç´¢å¼•ï¼ˆhierarchical indexingï¼‰
`unstack` `stack` `swaplevel` `sort_index` `set_index`

## 5.18
æ‰“æ‰«å«ç”Ÿä»¤äººç–²æƒ«

- æ’åˆ—å’Œéšæœºé‡‡æ ·`sample`
- è®¡ç®—æŒ‡æ ‡/å“‘å˜é‡`dummies = pd.get_dummies(df['key'], prefix='key')`
- å¤„ç†å­—ç¬¦ä¸²
- æ­£åˆ™è¡¨è¾¾å¼å¥½éš¾[æœ¬åœ°æ–‡ä»¶](file:///G:/python%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/python/%E7%88%AC%E8%99%AB%E5%B5%A9%E5%A4%A9/6%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.pdf)

## 5.17
æ‰­ä¼¤åæ­£ç¡®å¤„ç†æ­¥éª¤ï¼šç«‹é©¬å†·æ•·ï¼Œ24håçƒ­æ•·ï¼å¸Œæœ›æˆ‘å†ä¹Ÿç”¨ä¸åˆ°è¿™æ ·çš„çŸ¥è¯†ï¼

- `pd.read_sql()`
- `fillna()`
![](8.jpg)
- `replace` `rename` `cut`ç­‰
## 5.16
æˆ‘ã€ç˜¸ã€äº†å‘œå‘œå‘œ

- ç®€å•ç»Ÿè®¡
```
data = pd.DataFrame({'Qu1': [1, 3, 4, 3, 4], 'Qu2': [2, 3, 1, 2, 3],'Qu3': [1, 5, 2, 4, 4]})
result = data.apply(pd.value_counts).fillna(0)
```
- è¯»å†™æ–‡æœ¬æ ¼å¼çš„æ•°æ®
å±‚æ¬¡èŠ±ç´¢å¼•
```
from lxml import objectify
from io import StringIO
tag = '<a href="http://www.google.com">Google</a>'
root = objectify.parse(StringIO(tag)).getroot()
```

## 5.14
ä»Šæ—¥æœ‰äº†æ–°æƒ³æ³•ğŸ’ªğŸ’ªğŸ’ª

- Series
```
obj = pd.Series([4, 7, -5, 3], index=['d', 'b', 'a', 'c'])
# å®ƒä¼šæ ¹æ®è¿ç®—çš„ç´¢å¼•æ ‡ç­¾è‡ªåŠ¨å¯¹é½æ•°æ®
obj.name = 'population'
obj.index.name = "state"
```
- DataFrame
```
data = {'state': ['Ohio', 'Ohio', 'Ohio', 'Nevada', 'Nevada', 'Nevada'],
'year': [2000, 2001, 2002, 2001, 2002, 2003],
'pop': [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]}
frame = pd.DataFrame(data)

pop = {'Nevada': {2001: 2.4, 2002: 2.9},'Ohio': {2000: 1.5, 2001: 1.7, 2002: 3.6}}
frame = pd.DataFrame(pop)#å¤–å±‚å­—å…¸çš„é”®ä½œä¸ºåˆ—ï¼Œå†…å±‚é”®åˆ™ä½œä¸ºè¡Œç´¢å¼•ï¼š
frame.T #è½¬ç½®
frame3.values
```
  - Indexå¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ç”¨æˆ·ä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹
- é‡æ–°ç´¢å¼•`obj2 = obj.reindex(['a', 'b', 'c', 'd', 'e'])`,å¯¹ä¸dataframeæ¥è¯´åˆ—å¯ä»¥ç”¨`columns`å…³é”®å­—é‡æ–°ç´¢å¼•
- `drop`ä¸¢å¼ƒ
- ç´¢å¼• `loc`ï¼ˆæ ‡ç­¾ï¼‰`iloc`ï¼ˆæ•´æ•°ï¼‰
- é»˜è®¤æƒ…å†µä¸‹ï¼ŒDataFrameå’ŒSeriesä¹‹é—´çš„ç®—æœ¯è¿ç®—ä¼šå°†Seriesçš„ç´¢å¼•åŒ¹é…åˆ°DataFrameçš„åˆ—ï¼Œç„¶å
æ²¿ç€è¡Œä¸€ç›´å‘ä¸‹å¹¿æ’­
-  `frame.apply(f, axis='columns')` `applymap`ä¸`map`
- æ’åº`frame.sort_index(axis=1, ascending=False, by=)` rank?




## 5.13
- `np.save(),np.load()`
- `x.dot(y)`ç­‰ä»·äº`np.dot(x, y)`
- æ±‚è§£è¡Œåˆ—å¼ç­‰
```
from numpy.linalg import inv, qr
X = np.random.randn(5, 5)
mat = X.T.dot(X)
inv(mat)
mat.dot(inv(mat))
q, r = qr(mat)
```
![](6.jpg)
![](7.jpg)

## 5.12
```
arr = np.random.randn(7) * 5
remainder, whole_part = np.modf(arr)#å®ƒä¼šè¿”å›æµ®ç‚¹æ•°æ•°ç»„çš„å°æ•°å’Œæ•´æ•°éƒ¨åˆ†
```
```
points = np.arange(-5, 5, 0.01) 
xs, ys = np.meshgrid(points, points)
z = np.sqrt(xs ** 2 + ys ** 2)
import matplotlib.pyplot as plt
plt.imshow(z, cmap=plt.cm.gray); plt.colorbar()
plt.title("Image plot of $\sqrt{x^2 + y^2}$ for a grid of values")
```
- æ¡ä»¶è¡¨è¾¾

```
arr = np.random.randn(4, 4)
np.where(arr > 0, 2, arr) # set only positive values to 2
```
![](4.jpg)

![](5.jpg)

## 5.11
- èŠ±å¼ç´¢å¼•(Fancy indexing) æ˜¯ä¸€ä¸ªNumPyæœ¯è¯­ï¼Œå®ƒæŒ‡çš„æ˜¯åˆ©ç”¨æ•´æ•°æ•°ç»„è¿›è¡Œç´¢å¼•ã€‚èŠ±å¼ç´¢å¼•è·Ÿåˆ‡ç‰‡ä¸ä¸€æ ·ï¼Œå®ƒæ€»æ˜¯å°†æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚
- è½¬ç½®æ˜¯é‡å¡‘çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå®ƒè¿”å›çš„æ˜¯æºæ•°æ®çš„è§†å›¾ï¼ˆä¸ä¼šè¿›è¡Œä»»ä½•å¤åˆ¶æ“ä½œï¼‰ã€‚æ•°ç»„ä¸ä»…æœ‰`transpose`æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„Tå±æ€§:
```
#åˆ©ç”¨np.dotè®¡ç®—çŸ©é˜µå†…ç§¯
arr = np.random.randn(6, 3)
np.dot(arr, arr.T)
```
- å¯¹äºé«˜ç»´æ•°ç»„ï¼Œtransposeéœ€è¦å¾—åˆ°ä¸€ä¸ªç”±è½´ç¼–å·ç»„æˆçš„å…ƒç»„æ‰èƒ½å¯¹è¿™äº›è½´è¿›è¡Œè½¬ç½®,ndarrayè¿˜æœ‰ä¸€ä¸ªswapaxesæ–¹æ³•ï¼Œå®ƒéœ€è¦æ¥
å—ä¸€å¯¹è½´ç¼–å·


## 5.10
ä»Šå¤©ç»„åˆæ‘¸é±¼å“ˆå“ˆå“ˆæ¥äº†ï¼

- ndarrayæ˜¯ä¸€ä¸ªé€šç”¨çš„åŒæ„æ•°æ®å¤šç»´å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æ˜¯ç›¸åŒç±»å‹çš„ã€‚æ¯ä¸ªæ•°ç»„éƒ½æœ‰ä¸€ä¸ªshapeï¼ˆä¸€ä¸ªè¡¨ç¤ºå„ç»´åº¦å¤§å°çš„å…ƒç»„ï¼‰å’Œä¸€ä¸ªdtypeï¼ˆä¸€ä¸ªç”¨äºè¯´æ˜æ•°ç»„æ•°æ®ç±»å‹çš„å¯¹è±¡ï¼‰
- é€šè¿‡ndarrayçš„`astype`æ–¹æ³•æ˜ç¡®åœ°å°†ä¸€ä¸ªæ•°ç»„ä»ä¸€ä¸ªdtypeè½¬æ¢æˆå¦ä¸€ä¸ªdtype

æˆ‘å¯çœŸæ˜¯å¤ªå›°äº†ï¼Œä¸ºä»€ä¹ˆç»„ä¼šä¸åˆ†ä¸ªæœ¬ç¡•åšä¸‰ä¸ªç­‰çº§å¼€å‘¢å‘œå‘œå‘œğŸ˜­ğŸ˜­ğŸ˜­

## 5.9
- å­—å…¸çš„`setdefault`
- `collections`æ¨¡å—æœ‰ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„ç±»,`defaultdict`
- **å¯å“ˆå¸Œæ€§**:å­—å…¸çš„å€¼å¯ä»¥æ˜¯ä»»æ„Pythonå¯¹è±¡ï¼Œè€Œé”®é€šå¸¸æ˜¯ä¸å¯å˜çš„æ ‡é‡ç±»å‹ï¼ˆæ•´æ•°ã€æµ®ç‚¹å‹ã€å­—ç¬¦ä¸²ï¼‰æˆ–å…ƒ
ç»„ï¼ˆå…ƒç»„ä¸­çš„å¯¹è±¡å¿…é¡»æ˜¯ä¸å¯å˜çš„ï¼‰
- é›†åˆä½¿ç”¨æ–¹æ³•ï¼š
![](3.jpg)
- å†…ç½®çš„`map`å‡½æ•°ï¼Œå®ƒç”¨äºåœ¨ä¸€ç»„æ•°æ®ä¸Šåº”ç”¨ä¸€ä¸ªå‡½æ•°
- èƒ½ä»¥ä¸€ç§ä¸€è‡´çš„æ–¹å¼å¯¹åºåˆ—è¿›è¡Œè¿­ä»£ï¼ˆæ¯”å¦‚åˆ—è¡¨ä¸­çš„å¯¹è±¡æˆ–æ–‡ä»¶ä¸­çš„è¡Œï¼‰æ˜¯Pythonçš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹ã€‚**è¿­ä»£å™¨**æ˜¯ä¸€ç§ç‰¹æ®Šå¯¹è±¡ï¼Œå®ƒå¯ä»¥åœ¨è¯¸å¦‚forå¾ªç¯ä¹‹ç±»çš„ä¸Šä¸‹æ–‡ä¸­å‘Pythonè§£é‡Šå™¨è¾“é€å¯¹è±¡ã€‚
- ç”Ÿæˆå™¨ï¼ˆgeneratorï¼‰æ˜¯æ„é€ æ–°çš„å¯è¿­ä»£å¯¹è±¡çš„ä¸€ç§ç®€å•æ–¹å¼ã€‚ä¸€èˆ¬çš„å‡½æ•°æ‰§è¡Œä¹‹ååªä¼šè¿”å›å•ä¸ª
å€¼ï¼Œè€Œç”Ÿæˆå™¨åˆ™æ˜¯ä»¥å»¶è¿Ÿçš„æ–¹å¼è¿”å›ä¸€ä¸ªå€¼åºåˆ—ï¼Œå³æ¯è¿”å›ä¸€ä¸ªå€¼ä¹‹åæš‚åœï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªå€¼è¢«è¯·æ±‚æ—¶å†ç»§ç»­ã€‚è¦åˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨ï¼Œåªéœ€å°†å‡½æ•°ä¸­çš„returnæ›¿æ¢ä¸ºyeildå³å¯ã€‚
groupbyå¯ä»¥æ¥å—ä»»ä½•åºåˆ—å’Œä¸€ä¸ªå‡½æ•°ã€‚å®ƒæ ¹æ®å‡½æ•°çš„è¿”å›å€¼å¯¹åºåˆ—ä¸­çš„è¿ç»­å…ƒç´ è¿›è¡Œåˆ†ç»„ã€‚
```
import itertools
first_letter = lambda x: x[0]
names = ['Alan', 'Adam', 'Wes', 'Will', 'Albert', 'Steven']
for letter, names in itertools.groupby(names, first_letter):
  print(letter, list(names)) # names is a generator
```
åˆ°78é¡µäº†ï¼Œè¿™ä¸ª[ç”Ÿæˆå™¨è¿­ä»£å™¨](https://www.runoob.com/python3/python3-iterator-generator.html)æœ‰æå¤´
[è¿™ä¸ªä¹Ÿä¸é”™](https://zhuanlan.zhihu.com/p/341439647)

## 5.8
å•Šæˆ‘åˆšçœ‹å®ŒRçš„æ•°æ®ç±»å‹å¤´å¤§äº†å“ˆå“ˆå“ˆâœ‹

- Pythonæœ€è¿‘æ–°å¢äº†æ›´å¤šé«˜çº§çš„å…ƒç»„æ‹†åˆ†åŠŸèƒ½ï¼Œå…è®¸ä»å…ƒç»„çš„å¼€å¤´â€œæ‘˜å–â€å‡ ä¸ªå…ƒç´ ã€‚å®ƒä½¿ç”¨äº†ç‰¹æ®Šçš„
è¯­æ³• `*_`
- ç”¨`extend`æ–¹æ³•è¦æ¯”`+`ä¸²è”å¿«
-  `bisect`æ¨¡å—ï¼Œ`bisect.bisect` å¯ä»¥æ‰¾åˆ°æ’å…¥å€¼åä»ä¿è¯æ’åºçš„ä½ç½®ï¼Œ `bisect.insort` æ˜¯å‘è¿™ä¸ªä½ç½®æ’å…¥å€¼
- `enumerate`ğŸ˜
- `zip` å¯ä»¥å°†å¤šä¸ªåˆ—è¡¨ã€å…ƒç»„æˆ–å…¶å®ƒåºåˆ—æˆå¯¹ç»„åˆæˆä¸€ä¸ªå…ƒç»„åˆ—è¡¨ï¼š

ä»Šå¤©çœ‹åˆ°57é¡µï¼


## 5.7
ä¸€äº›è¡Œè¯ï¼š

- Munge/Munging/Wranglingï¼šæ•°æ®è§„æ•´
- Pseudocode ä¼ªç 
- Syntactic sugar è¯­æ³•ç³–

- Tabå¯ä»¥è¡¥å…¨~
- åœ¨å˜é‡å‰åä½¿ç”¨é—®å·ï¼Œå¯ä»¥æ˜¾ç¤ºå¯¹è±¡çš„ä¿¡æ¯
- jupyter notebookå¿«æ·é”®ï¼š

![](1.jpg)

- é­”æœ¯å‘½ä»¤æ˜¯åœ¨æŒ‡ä»¤å‰æ·»åŠ ç™¾åˆ†å·%å‰ç¼€ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨ `%timeit`æµ‹é‡ä»»ä½•Pythonè¯­å¥,ç”¨ `%quickref` æˆ– `%magic` å­¦ä¹ ä¸‹æ‰€æœ‰ç‰¹æ®Šå‘½ä»¤ã€‚

![](2.jpg)

- å¯ä»¥ç”¨ `obj.attribute_name` è®¿é—®å±æ€§å’Œæ–¹æ³•
- ç»å¸¸åœ°ï¼Œä½ å¯èƒ½ä¸å…³å¿ƒå¯¹è±¡çš„ç±»å‹ï¼Œåªå…³å¿ƒå¯¹è±¡æ˜¯å¦æœ‰æŸäº›æ–¹æ³•æˆ–ç”¨é€”ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºâ€œé¸­å­ç±»å‹â€ğŸ˜ƒæ¥è‡ªâ€œèµ°èµ·æ¥åƒé¸­å­ã€å«èµ·æ¥åƒé¸­å­ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­â€çš„è¯´æ³•ã€‚
- ä¸‰å…ƒè¡¨è¾¾å¼ `"positive" if x >= 0 else "negative`
- datetime

```
from datetime import datetime, date, time
dt = datetime(2011, 10, 29, 20, 30, 21)
dt.strftime('%m/%d/%Y %H:%M')#strftime æ–¹æ³•å¯ä»¥å°†datetimeæ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²
datetime.strptime('20091031', '%Y%m%d')
#strptime å¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆ datetime å¯¹è±¡ã€‚
```

