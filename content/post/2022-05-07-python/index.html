---
title: Pythonæ¯æ—¥éšå¿ƒè®°
author: zyy
date: '2022-05-07'
slug: python
categories: []
tags: []
---



<p>ä¹¦ç±åˆ—è¡¨(æ›´æ–°ä¸­)ï¼š</p>
<ul>
<li><a href="https://www.bookstack.cn/read/pyda-2e-zh/README.md">åˆ©ç”¨ Python è¿›è¡Œæ•°æ®åˆ†æ Â· ç¬¬ 2 ç‰ˆ</a>,ç¬¬3ç‰ˆå·²äº2022å¹´æ›´æ–°ï¼Œ<a href="https://wesmckinney.com/book/">ç¬¬3ç‰ˆç½‘å€</a></li>
</ul>
<div id="section" class="section level2">
<h2>5.16</h2>
<p>æˆ‘ã€ç˜¸ã€äº†å‘œå‘œå‘œ</p>
<ul>
<li>ç®€å•ç»Ÿè®¡</li>
</ul>
<pre><code>data = pd.DataFrame({&#39;Qu1&#39;: [1, 3, 4, 3, 4], &#39;Qu2&#39;: [2, 3, 1, 2, 3],&#39;Qu3&#39;: [1, 5, 2, 4, 4]})
result = data.apply(pd.value_counts).fillna(0)</code></pre>
<ul>
<li>è¯»å†™æ–‡æœ¬æ ¼å¼çš„æ•°æ®
å±‚æ¬¡èŠ±ç´¢å¼•</li>
</ul>
<pre><code>from lxml import objectify
from io import StringIO
tag = &#39;&lt;a href=&quot;http://www.google.com&quot;&gt;Google&lt;/a&gt;&#39;
root = objectify.parse(StringIO(tag)).getroot()</code></pre>
</div>
<div id="section-1" class="section level2">
<h2>5.14</h2>
<p>ä»Šæ—¥æœ‰äº†æ–°æƒ³æ³•ğŸ’ªğŸ’ªğŸ’ª</p>
<ul>
<li>Series</li>
</ul>
<pre><code>obj = pd.Series([4, 7, -5, 3], index=[&#39;d&#39;, &#39;b&#39;, &#39;a&#39;, &#39;c&#39;])
# å®ƒä¼šæ ¹æ®è¿ç®—çš„ç´¢å¼•æ ‡ç­¾è‡ªåŠ¨å¯¹é½æ•°æ®
obj.name = &#39;population&#39;
obj.index.name = &quot;state&quot;</code></pre>
<ul>
<li>DataFrame</li>
</ul>
<pre><code>data = {&#39;state&#39;: [&#39;Ohio&#39;, &#39;Ohio&#39;, &#39;Ohio&#39;, &#39;Nevada&#39;, &#39;Nevada&#39;, &#39;Nevada&#39;],
&#39;year&#39;: [2000, 2001, 2002, 2001, 2002, 2003],
&#39;pop&#39;: [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]}
frame = pd.DataFrame(data)

pop = {&#39;Nevada&#39;: {2001: 2.4, 2002: 2.9},&#39;Ohio&#39;: {2000: 1.5, 2001: 1.7, 2002: 3.6}}
frame = pd.DataFrame(pop)#å¤–å±‚å­—å…¸çš„é”®ä½œä¸ºåˆ—ï¼Œå†…å±‚é”®åˆ™ä½œä¸ºè¡Œç´¢å¼•ï¼š
frame.T #è½¬ç½®
frame3.values</code></pre>
<ul>
<li>Indexå¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ç”¨æˆ·ä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹</li>
<li>é‡æ–°ç´¢å¼•<code>obj2 = obj.reindex(['a', 'b', 'c', 'd', 'e'])</code>,å¯¹ä¸dataframeæ¥è¯´åˆ—å¯ä»¥ç”¨<code>columns</code>å…³é”®å­—é‡æ–°ç´¢å¼•</li>
<li><code>drop</code>ä¸¢å¼ƒ</li>
<li>ç´¢å¼• <code>loc</code>ï¼ˆæ ‡ç­¾ï¼‰<code>iloc</code>ï¼ˆæ•´æ•°ï¼‰</li>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒDataFrameå’ŒSeriesä¹‹é—´çš„ç®—æœ¯è¿ç®—ä¼šå°†Seriesçš„ç´¢å¼•åŒ¹é…åˆ°DataFrameçš„åˆ—ï¼Œç„¶å
æ²¿ç€è¡Œä¸€ç›´å‘ä¸‹å¹¿æ’­</li>
<li><code>frame.apply(f, axis='columns')</code> <code>applymap</code>ä¸<code>map</code></li>
<li>æ’åº<code>frame.sort_index(axis=1, ascending=False, by=)</code> rank?</li>
</ul>
</div>
<div id="section-2" class="section level2">
<h2>5.13</h2>
<ul>
<li><code>np.save(),np.load()</code></li>
<li><code>x.dot(y)</code>ç­‰ä»·äº<code>np.dot(x, y)</code></li>
<li>æ±‚è§£è¡Œåˆ—å¼ç­‰</li>
</ul>
<pre><code>from numpy.linalg import inv, qr
X = np.random.randn(5, 5)
mat = X.T.dot(X)
inv(mat)
mat.dot(inv(mat))
q, r = qr(mat)</code></pre>
<p><img src="6.jpg" />
<img src="7.jpg" /></p>
</div>
<div id="section-3" class="section level2">
<h2>5.12</h2>
<pre><code>arr = np.random.randn(7) * 5
remainder, whole_part = np.modf(arr)#å®ƒä¼šè¿”å›æµ®ç‚¹æ•°æ•°ç»„çš„å°æ•°å’Œæ•´æ•°éƒ¨åˆ†</code></pre>
<pre><code>points = np.arange(-5, 5, 0.01) 
xs, ys = np.meshgrid(points, points)
z = np.sqrt(xs ** 2 + ys ** 2)
import matplotlib.pyplot as plt
plt.imshow(z, cmap=plt.cm.gray); plt.colorbar()
plt.title(&quot;Image plot of $\sqrt{x^2 + y^2}$ for a grid of values&quot;)</code></pre>
<ul>
<li>æ¡ä»¶è¡¨è¾¾</li>
</ul>
<pre><code>arr = np.random.randn(4, 4)
np.where(arr &gt; 0, 2, arr) # set only positive values to 2</code></pre>
<p><img src="4.jpg" /></p>
<p><img src="5.jpg" /></p>
</div>
<div id="section-4" class="section level2">
<h2>5.11</h2>
<ul>
<li>èŠ±å¼ç´¢å¼•(Fancy indexing) æ˜¯ä¸€ä¸ªNumPyæœ¯è¯­ï¼Œå®ƒæŒ‡çš„æ˜¯åˆ©ç”¨æ•´æ•°æ•°ç»„è¿›è¡Œç´¢å¼•ã€‚èŠ±å¼ç´¢å¼•è·Ÿåˆ‡ç‰‡ä¸ä¸€æ ·ï¼Œå®ƒæ€»æ˜¯å°†æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚</li>
<li>è½¬ç½®æ˜¯é‡å¡‘çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå®ƒè¿”å›çš„æ˜¯æºæ•°æ®çš„è§†å›¾ï¼ˆä¸ä¼šè¿›è¡Œä»»ä½•å¤åˆ¶æ“ä½œï¼‰ã€‚æ•°ç»„ä¸ä»…æœ‰<code>transpose</code>æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„Tå±æ€§:</li>
</ul>
<pre><code>#åˆ©ç”¨np.dotè®¡ç®—çŸ©é˜µå†…ç§¯
arr = np.random.randn(6, 3)
np.dot(arr, arr.T)</code></pre>
<ul>
<li>å¯¹äºé«˜ç»´æ•°ç»„ï¼Œtransposeéœ€è¦å¾—åˆ°ä¸€ä¸ªç”±è½´ç¼–å·ç»„æˆçš„å…ƒç»„æ‰èƒ½å¯¹è¿™äº›è½´è¿›è¡Œè½¬ç½®,ndarrayè¿˜æœ‰ä¸€ä¸ªswapaxesæ–¹æ³•ï¼Œå®ƒéœ€è¦æ¥
å—ä¸€å¯¹è½´ç¼–å·</li>
</ul>
</div>
<div id="section-5" class="section level2">
<h2>5.10</h2>
<p>ä»Šå¤©ç»„åˆæ‘¸é±¼å“ˆå“ˆå“ˆæ¥äº†ï¼</p>
<ul>
<li>ndarrayæ˜¯ä¸€ä¸ªé€šç”¨çš„åŒæ„æ•°æ®å¤šç»´å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æ˜¯ç›¸åŒç±»å‹çš„ã€‚æ¯ä¸ªæ•°ç»„éƒ½æœ‰ä¸€ä¸ªshapeï¼ˆä¸€ä¸ªè¡¨ç¤ºå„ç»´åº¦å¤§å°çš„å…ƒç»„ï¼‰å’Œä¸€ä¸ªdtypeï¼ˆä¸€ä¸ªç”¨äºè¯´æ˜æ•°ç»„æ•°æ®ç±»å‹çš„å¯¹è±¡ï¼‰</li>
<li>é€šè¿‡ndarrayçš„<code>astype</code>æ–¹æ³•æ˜ç¡®åœ°å°†ä¸€ä¸ªæ•°ç»„ä»ä¸€ä¸ªdtypeè½¬æ¢æˆå¦ä¸€ä¸ªdtype</li>
</ul>
<p>æˆ‘å¯çœŸæ˜¯å¤ªå›°äº†ï¼Œä¸ºä»€ä¹ˆç»„ä¼šä¸åˆ†ä¸ªæœ¬ç¡•åšä¸‰ä¸ªç­‰çº§å¼€å‘¢å‘œå‘œå‘œğŸ˜­ğŸ˜­ğŸ˜­</p>
</div>
<div id="section-6" class="section level2">
<h2>5.9</h2>
<ul>
<li>å­—å…¸çš„<code>setdefault</code></li>
<li><code>collections</code>æ¨¡å—æœ‰ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„ç±»,<code>defaultdict</code></li>
<li><strong>å¯å“ˆå¸Œæ€§</strong>:å­—å…¸çš„å€¼å¯ä»¥æ˜¯ä»»æ„Pythonå¯¹è±¡ï¼Œè€Œé”®é€šå¸¸æ˜¯ä¸å¯å˜çš„æ ‡é‡ç±»å‹ï¼ˆæ•´æ•°ã€æµ®ç‚¹å‹ã€å­—ç¬¦ä¸²ï¼‰æˆ–å…ƒ
ç»„ï¼ˆå…ƒç»„ä¸­çš„å¯¹è±¡å¿…é¡»æ˜¯ä¸å¯å˜çš„ï¼‰</li>
<li>é›†åˆä½¿ç”¨æ–¹æ³•ï¼š
<img src="3.jpg" /></li>
<li>å†…ç½®çš„<code>map</code>å‡½æ•°ï¼Œå®ƒç”¨äºåœ¨ä¸€ç»„æ•°æ®ä¸Šåº”ç”¨ä¸€ä¸ªå‡½æ•°</li>
<li>èƒ½ä»¥ä¸€ç§ä¸€è‡´çš„æ–¹å¼å¯¹åºåˆ—è¿›è¡Œè¿­ä»£ï¼ˆæ¯”å¦‚åˆ—è¡¨ä¸­çš„å¯¹è±¡æˆ–æ–‡ä»¶ä¸­çš„è¡Œï¼‰æ˜¯Pythonçš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹ã€‚<strong>è¿­ä»£å™¨</strong>æ˜¯ä¸€ç§ç‰¹æ®Šå¯¹è±¡ï¼Œå®ƒå¯ä»¥åœ¨è¯¸å¦‚forå¾ªç¯ä¹‹ç±»çš„ä¸Šä¸‹æ–‡ä¸­å‘Pythonè§£é‡Šå™¨è¾“é€å¯¹è±¡ã€‚</li>
<li>ç”Ÿæˆå™¨ï¼ˆgeneratorï¼‰æ˜¯æ„é€ æ–°çš„å¯è¿­ä»£å¯¹è±¡çš„ä¸€ç§ç®€å•æ–¹å¼ã€‚ä¸€èˆ¬çš„å‡½æ•°æ‰§è¡Œä¹‹ååªä¼šè¿”å›å•ä¸ª
å€¼ï¼Œè€Œç”Ÿæˆå™¨åˆ™æ˜¯ä»¥å»¶è¿Ÿçš„æ–¹å¼è¿”å›ä¸€ä¸ªå€¼åºåˆ—ï¼Œå³æ¯è¿”å›ä¸€ä¸ªå€¼ä¹‹åæš‚åœï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªå€¼è¢«è¯·æ±‚æ—¶å†ç»§ç»­ã€‚è¦åˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨ï¼Œåªéœ€å°†å‡½æ•°ä¸­çš„returnæ›¿æ¢ä¸ºyeildå³å¯ã€‚
groupbyå¯ä»¥æ¥å—ä»»ä½•åºåˆ—å’Œä¸€ä¸ªå‡½æ•°ã€‚å®ƒæ ¹æ®å‡½æ•°çš„è¿”å›å€¼å¯¹åºåˆ—ä¸­çš„è¿ç»­å…ƒç´ è¿›è¡Œåˆ†ç»„ã€‚</li>
</ul>
<pre><code>import itertools
first_letter = lambda x: x[0]
names = [&#39;Alan&#39;, &#39;Adam&#39;, &#39;Wes&#39;, &#39;Will&#39;, &#39;Albert&#39;, &#39;Steven&#39;]
for letter, names in itertools.groupby(names, first_letter):
  print(letter, list(names)) # names is a generator</code></pre>
<p>åˆ°78é¡µäº†ï¼Œè¿™ä¸ª<a href="https://www.runoob.com/python3/python3-iterator-generator.html">ç”Ÿæˆå™¨è¿­ä»£å™¨</a>æœ‰æå¤´
<a href="https://zhuanlan.zhihu.com/p/341439647">è¿™ä¸ªä¹Ÿä¸é”™</a></p>
</div>
<div id="section-7" class="section level2">
<h2>5.8</h2>
<p>å•Šæˆ‘åˆšçœ‹å®ŒRçš„æ•°æ®ç±»å‹å¤´å¤§äº†å“ˆå“ˆå“ˆâœ‹</p>
<ul>
<li>Pythonæœ€è¿‘æ–°å¢äº†æ›´å¤šé«˜çº§çš„å…ƒç»„æ‹†åˆ†åŠŸèƒ½ï¼Œå…è®¸ä»å…ƒç»„çš„å¼€å¤´â€œæ‘˜å–â€å‡ ä¸ªå…ƒç´ ã€‚å®ƒä½¿ç”¨äº†ç‰¹æ®Šçš„
è¯­æ³• <code>*_</code></li>
<li>ç”¨<code>extend</code>æ–¹æ³•è¦æ¯”<code>+</code>ä¸²è”å¿«</li>
<li><code>bisect</code>æ¨¡å—ï¼Œ<code>bisect.bisect</code> å¯ä»¥æ‰¾åˆ°æ’å…¥å€¼åä»ä¿è¯æ’åºçš„ä½ç½®ï¼Œ <code>bisect.insort</code> æ˜¯å‘è¿™ä¸ªä½ç½®æ’å…¥å€¼</li>
<li><code>enumerate</code>ğŸ˜</li>
<li><code>zip</code> å¯ä»¥å°†å¤šä¸ªåˆ—è¡¨ã€å…ƒç»„æˆ–å…¶å®ƒåºåˆ—æˆå¯¹ç»„åˆæˆä¸€ä¸ªå…ƒç»„åˆ—è¡¨ï¼š</li>
</ul>
<p>ä»Šå¤©çœ‹åˆ°57é¡µï¼</p>
</div>
<div id="section-8" class="section level2">
<h2>5.7</h2>
<p>ä¸€äº›è¡Œè¯ï¼š</p>
<ul>
<li><p>Munge/Munging/Wranglingï¼šæ•°æ®è§„æ•´</p></li>
<li><p>Pseudocode ä¼ªç </p></li>
<li><p>Syntactic sugar è¯­æ³•ç³–</p></li>
<li><p>Tabå¯ä»¥è¡¥å…¨~</p></li>
<li><p>åœ¨å˜é‡å‰åä½¿ç”¨é—®å·ï¼Œå¯ä»¥æ˜¾ç¤ºå¯¹è±¡çš„ä¿¡æ¯</p></li>
<li><p>jupyter notebookå¿«æ·é”®ï¼š</p></li>
</ul>
<p><img src="1.jpg" /></p>
<ul>
<li>é­”æœ¯å‘½ä»¤æ˜¯åœ¨æŒ‡ä»¤å‰æ·»åŠ ç™¾åˆ†å·%å‰ç¼€ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨ <code>%timeit</code>æµ‹é‡ä»»ä½•Pythonè¯­å¥,ç”¨ <code>%quickref</code> æˆ– <code>%magic</code> å­¦ä¹ ä¸‹æ‰€æœ‰ç‰¹æ®Šå‘½ä»¤ã€‚</li>
</ul>
<p><img src="2.jpg" /></p>
<ul>
<li>å¯ä»¥ç”¨ <code>obj.attribute_name</code> è®¿é—®å±æ€§å’Œæ–¹æ³•</li>
<li>ç»å¸¸åœ°ï¼Œä½ å¯èƒ½ä¸å…³å¿ƒå¯¹è±¡çš„ç±»å‹ï¼Œåªå…³å¿ƒå¯¹è±¡æ˜¯å¦æœ‰æŸäº›æ–¹æ³•æˆ–ç”¨é€”ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºâ€œé¸­å­ç±»å‹â€ğŸ˜ƒæ¥è‡ªâ€œèµ°èµ·æ¥åƒé¸­å­ã€å«èµ·æ¥åƒé¸­å­ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­â€çš„è¯´æ³•ã€‚</li>
<li>ä¸‰å…ƒè¡¨è¾¾å¼ <code>"positive" if x &gt;= 0 else "negative</code></li>
<li>datetime</li>
</ul>
<pre><code>from datetime import datetime, date, time
dt = datetime(2011, 10, 29, 20, 30, 21)
dt.strftime(&#39;%m/%d/%Y %H:%M&#39;)#strftime æ–¹æ³•å¯ä»¥å°†datetimeæ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²
datetime.strptime(&#39;20091031&#39;, &#39;%Y%m%d&#39;)
#strptime å¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆ datetime å¯¹è±¡ã€‚</code></pre>
</div>
