---
title: Ræ¯æ—¥éšå¿ƒè®°
author: zyy
date: '2022-05-07'
slug: r
categories: []
tags: []
---



<p>è¿™ä¸‰ç§è¯­è¨€è¯´ç†Ÿæ‚‰ä¹Ÿç†Ÿæ‚‰ï¼Œä½†æ€»è§‰å¾—ç¼ºä¹ä¸€ç§ç³»ç»Ÿæ„Ÿï¼Œé‚£å°±æ¯å¤©èŠ±ç‚¹æ—¶é—´æµè§ˆä¸€äº›ä¹¦ç±è®°å½•ä¸€ä¸‹å§ï¼</p>
<p>ä¹¦ç±åˆ—è¡¨(æ›´æ–°ä¸­)ï¼š</p>
<ul>
<li>Rè¯­è¨€å®æˆ˜(ç¬¬2ç‰ˆ)</li>
</ul>
<pre class="r"><code>knitr::opts_chunk$set(echo = T,collapse = T,
                      results = &quot;hide&quot;)</code></pre>
<div id="section" class="section level2">
<h2>5.13</h2>
<p>ç¡å¾—å¥½æ˜¯çœŸçš„å¾ˆé‡è¦å‘€</p>
<pre class="r"><code>options(digits=2)#)é™å®šäº†è¾“å‡ºå°æ•°ç‚¹åæ•°å­—ä½æ•°
Student &lt;- c(&quot;John Davis&quot;, &quot;Angela Williams&quot;, 
    &quot;Bullwinkle Moose&quot;, &quot;David Jones&quot;, 
    &quot;Janice Markhammer&quot;, &quot;Cheryl Cushing&quot;,
    &quot;Reuven Ytzrhak&quot;, &quot;Greg Knox&quot;, &quot;Joel England&quot;,
    &quot;Mary Rayburn&quot;)
Math &lt;- c(502, 600, 412, 358, 495, 512, 410, 625, 573, 522)
Science &lt;- c(95, 99, 80, 82, 75, 85, 80, 95, 89, 86)
English &lt;- c(25, 22, 18, 15, 20, 28, 15, 30, 27, 18)
roster &lt;- data.frame(Student, Math, Science, English,stringsAsFactors=FALSE)
    
z &lt;- scale(roster[,2:4]) #å°†å˜é‡è¿›è¡Œæ ‡å‡†åŒ–

score &lt;- apply(z, 1, mean)                     
roster &lt;- cbind(roster, score)
#é€šè¿‡å‡½æ•°mean()æ¥è®¡ç®—å„è¡Œçš„å‡å€¼ä»¥è·å¾—ç»¼åˆå¾—åˆ†ï¼Œå¹¶ä½¿ç”¨å‡½æ•°cbind()å°†å…¶æ·»åŠ åˆ°èŠ±åå†Œä¸­ 
y &lt;- quantile(score, c(.8,.6,.4,.2)) #å‡½æ•°quantile()ç»™å‡ºäº†å­¦ç”Ÿç»¼åˆå¾—åˆ†çš„ç™¾åˆ†ä½æ•°                                  
roster$grade[score &gt;= y[1]] &lt;- &quot;A&quot;           
roster$grade[score &lt; y[1] &amp; score &gt;= y[2]] &lt;- &quot;B&quot;
roster$grade[score &lt; y[2] &amp; score &gt;= y[3]] &lt;- &quot;C&quot;
roster$grade[score &lt; y[3] &amp; score &gt;= y[4]] &lt;- &quot;D&quot;
roster$grade[score &lt; y[4]] &lt;- &quot;F&quot;

name &lt;- strsplit((roster$Student), &quot; &quot;) #ä½¿ç”¨å‡½æ•°strsplit()ä»¥ç©ºæ ¼ä¸ºç•ŒæŠŠå­¦ç”Ÿå§“åæ‹†åˆ†ä¸ºå§“æ°å’Œåå­—           
#ä½ å¯ä»¥ä½¿ç”¨å‡½æ•°sapply()æå–åˆ—è¡¨ä¸­æ¯ä¸ªæˆåˆ†çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ”¾å…¥ä¸€ä¸ªå‚¨å­˜åå­—çš„å‘é‡Firstnameï¼Œå¹¶æå–æ¯ä¸ªæˆåˆ†çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œæ”¾å…¥ä¸€ä¸ªå‚¨å­˜å§“æ°çš„å‘é‡Lastnameã€‚&quot;[&quot;æ˜¯ä¸€ä¸ªå¯ä»¥æå–æŸä¸ªå¯¹è±¡çš„ä¸€éƒ¨åˆ†çš„å‡½æ•°â€”â€”åœ¨è¿™é‡Œå®ƒæ˜¯ç”¨æ¥æå–åˆ—è¡¨nameå„æˆåˆ†ä¸­çš„ç¬¬ä¸€ä¸ªæˆ–ç¬¬äºŒä¸ªå…ƒç´ çš„ã€‚
lastname &lt;- sapply(name, &quot;[&quot;, 2)
firstname &lt;- sapply(name, &quot;[&quot;, 1)

roster &lt;- cbind(firstname,lastname, roster[,-1])
roster &lt;- roster[order(lastname,firstname),]

roster</code></pre>
<pre class="r"><code># for
for (i in 1:10) 
    print(i)
# while
i &lt;- 10 
while (i &gt; 0) {
    print(i)
    i &lt;- i - 1} </code></pre>
<ul>
<li>if
<ul>
<li><code>if (cond) statement1 else statement2</code></li>
<li><code>ifelse(cond, statement1, statement2)</code></li>
</ul></li>
<li>switch <code>switch(expr, ...)</code></li>
</ul>
<pre class="r"><code>mydate &lt;- function(type=&quot;long&quot;) {
    switch(type,
    long =  format(Sys.time(), &quot;%A %B %d %Y&quot;), 
    short = format(Sys.time(), &quot;%m-%d-%y&quot;),
    cat(type, &quot;is not a recognized type\n&quot;))
}
mydate(&quot;long&quot;)
mydate(&quot;short&quot;)
mydate()
mydate(&quot;medium&quot;)</code></pre>
<ul>
<li>å‡½æ•°</li>
</ul>
<pre><code>myfunction &lt;- function(arg1, arg2, ... ){ 
 statements 
 return(object) 
} </code></pre>
<p><img src="5.jpg" /></p>
<ul>
<li>åŒ…reshape2 <code>æ•°melt()å’Œdcast()</code></li>
</ul>
</div>
<div id="section-1" class="section level2">
<h2>5.12</h2>
<p>æ˜¨æ™šæ˜¯è¢«èšŠå­æ¯æ‰çš„ç¡çœ ï¼</p>
<pre class="r"><code>x &lt;- c(1, 2, 3, 4, 5, 6, 7, 8)
mean(x)
sd(x)</code></pre>
<p><img src="2.jpg" /></p>
<pre class="r"><code># normal distribution
library(MASS)
## Warning: ç¨‹è¾‘åŒ…&#39;MASS&#39;æ˜¯ç”¨Rç‰ˆæœ¬4.0.5 æ¥å»ºé€ çš„
options(digits=3)
set.seed(1234)
mean &lt;- c(230.7, 146.7, 3.6)           
sigma &lt;- matrix( c(15360.8, 6721.2, -47.1,                           6721.2, 4700.9, -16.5,
            -47.1,  -16.5,   0.3), nrow=3, ncol=3)
mydata &lt;- mvrnorm(500, mean, sigma)             
mydata &lt;- as.data.frame(mydata)                   
names(mydata) &lt;- c(&quot;y&quot;, &quot;x1&quot;, &quot;x2&quot;)               
dim(mydata)
head(mydata, n=10)   </code></pre>
<ul>
<li>å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</li>
<li>å…¶ä»–æœ‰ç”¨å‡½æ•°
<img src="4.jpg" /></li>
<li>Rä¸­æä¾›äº†ä¸€ä¸ª<code>apply()</code>å‡½æ•°ï¼Œå¯å°†ä¸€ä¸ªä»»æ„å‡½æ•°â€œåº”ç”¨â€åˆ°çŸ©é˜µã€æ•°ç»„ã€æ•°æ®æ¡†çš„ä»»ä½•ç»´
åº¦ä¸Šã€‚<code>apply()</code>å‡½æ•°çš„ä½¿ç”¨æ ¼å¼ä¸ºï¼š
<code>apply(x, MARGIN, FUN, ...)</code></li>
</ul>
</div>
<div id="section-2" class="section level2">
<h2>5.11</h2>
<p>ç­”è¾©è®©æˆ‘å¥½ç–²æƒ«ã€‚ã€‚</p>
<ul>
<li>æ—¥æœŸ</li>
</ul>
<pre class="r"><code>mydates &lt;- as.Date(c(&quot;2007-06-22&quot;,&quot;2004-02-13&quot;)) 
today &lt;- Sys.Date() 
format(today, format=&quot;%B %d %Y&quot;) 
dob &lt;- as.Date(&quot;2000-01-02&quot;)
difftime(today, dob, units=&quot;weeks&quot;) 
#strDates &lt;- as.character(dates)å°†æ—¥æœŸè½¬ä¸ºå­—ç¬¦</code></pre>
<p><img src="1.jpg" /></p>
<pre class="r"><code>a &lt;- c(1, 2, 3)
a
is.numeric(a)
is.vector(a)
a &lt;- as.character(a)
a
is.numeric(a)
is.vector(a)
is.character(a)</code></pre>
<ul>
<li>ä½¿ç”¨<code>order()</code>å‡½æ•°å¯¹ä¸€ä¸ªæ•°æ®æ¡†è¿›è¡Œæ’åºã€‚é»˜è®¤çš„æ’åºé¡ºåºæ˜¯å‡åºã€‚åœ¨æ’åºå˜é‡çš„å‰è¾¹åŠ ä¸€ä¸ªå‡å·å³å¯å¾—åˆ°é™åºçš„æ’åºç»“æœ</li>
<li>æ¨ªå‘åˆå¹¶ä¸¤ä¸ªæ•°æ®æ¡†ï¼ˆæ•°æ®é›†ï¼‰ï¼Œä½¿ç”¨<code>merge()</code>å‡½æ•°ï¼Œ<code>rbind(),cbind()</code></li>
<li><code>subset()</code>å‡½æ•°å¤§æ¦‚æ˜¯é€‰æ‹©å˜é‡å’Œè§‚æµ‹æœ€ç®€å•çš„æ–¹æ³•</li>
<li><code>sample()</code>å‡½æ•°èƒ½å¤Ÿè®©ä½ ä»æ•°æ®é›†ä¸­ï¼ˆæœ‰æ”¾å›æˆ–æ— æ”¾å›åœ°ï¼‰æŠ½å–å¤§å°ä¸ºnçš„ä¸€ä¸ªéšæœºæ ·æœ¬</li>
</ul>
<pre class="r"><code>library(sqldf)
## Warning: ç¨‹è¾‘åŒ…&#39;sqldf&#39;æ˜¯ç”¨Rç‰ˆæœ¬4.0.5 æ¥å»ºé€ çš„
## è½½å…¥éœ€è¦çš„ç¨‹è¾‘åŒ…ï¼šgsubfn
## Warning: ç¨‹è¾‘åŒ…&#39;gsubfn&#39;æ˜¯ç”¨Rç‰ˆæœ¬4.0.5 æ¥å»ºé€ çš„
## è½½å…¥éœ€è¦çš„ç¨‹è¾‘åŒ…ï¼šproto
## Warning: ç¨‹è¾‘åŒ…&#39;proto&#39;æ˜¯ç”¨Rç‰ˆæœ¬4.0.5 æ¥å»ºé€ çš„
## è½½å…¥éœ€è¦çš„ç¨‹è¾‘åŒ…ï¼šRSQLite
newdf &lt;- sqldf(&quot;select * from mtcars where carb=1 order by mpg&quot;, 
    row.names = TRUE)
newdf &lt;- sqldf(&quot;select avg(mpg) as avg_mpg, avg(disp) as avg_disp,
    gear from mtcars where cyl in (4, 6) group by gear&quot;)</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>5.10</h2>
<pre class="r"><code>mydata &lt;- data.frame(x1 = c(2, 2, 6, 4), x2 = c(3, 4, 2, 8))
mydata$sumx &lt;- mydata$x1 + mydata$x2
mydata$meanx &lt;- (mydata$x1 + mydata$x2)/2
attach(mydata)
mydata$sumx &lt;- x1 + x2
mydata$meanx &lt;- (x1 + x2)/2
detach(mydata)
mydata &lt;- transform(mydata, sumx = x1 + x2, meanx = (x1 + x2)/2)</code></pre>
<ul>
<li>plyråŒ…ä¸­æœ‰ä¸€ä¸ª<code>rename()</code>å‡½æ•°ï¼Œå¯ç”¨äºä¿®æ”¹å˜é‡å</li>
</ul>
<pre class="r"><code>y &lt;- c(1, 2, 3, NA) 
print(is.na(y))
x &lt;- c(1, 2, NA, 3) 
print(sum(x, na.rm=TRUE))</code></pre>
<ul>
<li><code>na.omit()</code>å¯ä»¥åˆ é™¤æ‰€æœ‰å«æœ‰ç¼ºå¤±æ•°æ®çš„è¡Œ</li>
</ul>
</div>
<div id="section-4" class="section level2">
<h2>5.9</h2>
<pre class="r"><code>attach(mtcars)
plot(wt, mpg)
abline(lm(mpg ~ wt))
title(&quot;Regression of MPG on Weight&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>detach(mtcars)</code></pre>
<ul>
<li>å¯ç”¨<code>par(optionname=value,optionname=name,...)</code>ä¿®æ”¹å›¾å½¢å‚æ•°ï¼Œä¹Ÿå¯ç”¨é«˜çº§ç»˜å›¾å‡½æ•°ç›´æ¥æä¾›çš„optionname=valueçš„é”®å€¼å¯¹</li>
<li>å‡½æ•°<code>colors()</code>å¯ä»¥è¿”å›æ‰€æœ‰å¯ç”¨é¢œè‰²çš„åç§°</li>
<li>å‡½æ•°<code>plotmath()</code>å¯ä»¥ä¸ºå›¾å½¢ä¸»ä½“æˆ–è¾¹ç•Œä¸Šçš„æ ‡é¢˜ã€åæ ‡è½´åç§°æˆ–æ–‡æœ¬æ ‡æ³¨æ·»åŠ æ•°å­¦ç¬¦å·</li>
<li><code>layout()</code>ğŸ‘</li>
</ul>
</div>
<div id="section-5" class="section level2">
<h2>5.8</h2>
<pre class="r"><code>#çŸ©é˜µ
y = matrix(1:20,nrow = 5, ncol = 4)
y
cells &lt;- c(1, 26, 24, 68)
rnames &lt;- c(&quot;R1&quot;, &quot;R2&quot;)
cnames &lt;- c(&quot;C1&quot;, &quot;C2&quot;)
mymatrix &lt;- matrix(cells, nrow = 2, ncol = 2, byrow = TRUE, 
    dimnames = list(rnames, cnames))
mymatrix
mymatrix &lt;- matrix(cells, nrow = 2, ncol = 2, byrow = FALSE, 
    dimnames = list(rnames, cnames))
mymatrix
#æ•°ç»„ï¼šä¸ªåˆ›å»ºä¸‰ç»´ï¼ˆ2Ã—3Ã—4ï¼‰æ•°å€¼å‹æ•°ç»„
dim1 &lt;- c(&quot;A1&quot;, &quot;A2&quot;)
dim2 &lt;- c(&quot;B1&quot;, &quot;B2&quot;, &quot;B3&quot;)
dim3 &lt;- c(&quot;C1&quot;, &quot;C2&quot;, &quot;C3&quot;, &quot;C4&quot;)
z &lt;- array(1:24, c(2, 3, 4), dimnames = list(dim1, dim2, dim3))
z</code></pre>
<pre class="r"><code>#åˆ›å»ºæ•°æ®æ¡†
patientID &lt;- c(1, 2, 3, 4)
age &lt;- c(25, 34, 28, 52)
diabetes &lt;- c(&quot;Type1&quot;, &quot;Type2&quot;, &quot;Type1&quot;, &quot;Type1&quot;)
status &lt;- c(&quot;Poor&quot;, &quot;Improved&quot;, &quot;Excellent&quot;, &quot;Poor&quot;)
patientdata &lt;- data.frame(patientID, age, diabetes, 
    status)
patientdata
patientdata$age
table(patientdata$diabetes, patientdata$status)#ç”Ÿæˆç³–å°¿ç—…ç±»å‹å˜é‡diabeteså’Œç—…æƒ…å˜é‡statusçš„åˆ—è”è¡¨</code></pre>
<ul>
<li>å‡½æ•°attach()å¯å°†æ•°æ®æ¡†æ·»åŠ åˆ°Rçš„æœç´¢è·¯å¾„ä¸­ã€‚Råœ¨é‡åˆ°ä¸€ä¸ªå˜é‡åä»¥åï¼Œå°†æ£€æŸ¥æœç´¢è·¯å¾„ä¸­çš„æ•°æ®æ¡†ï¼Œä½†æ˜¯<a href="https://google.github.io/styleguide/Rguide.html">Rä»£ç é£æ ¼è¯´æ˜</a>é‡Œè¯´æœ€å¥½ä¸è¦ç”¨å™¢å“ˆå“ˆå“ˆ</li>
<li><strong>with</strong></li>
<li>ç±»åˆ«ï¼ˆåä¹‰å‹ï¼‰å˜é‡å’Œæœ‰åºç±»åˆ«ï¼ˆæœ‰åºå‹ï¼‰å˜é‡åœ¨Rä¸­ç§°ä¸ºå› å­ï¼ˆfactorï¼‰</li>
</ul>
<pre class="r"><code>patientID &lt;- c(1, 2, 3, 4)
age &lt;- c(25, 34, 28, 52)
diabetes &lt;- c(&quot;Type1&quot;, &quot;Type2&quot;, &quot;Type1&quot;, &quot;Type1&quot;)
status &lt;- c(&quot;Poor&quot;, &quot;Improved&quot;, &quot;Excellent&quot;, &quot;Poor&quot;)
diabetes &lt;- factor(diabetes)
status &lt;- factor(status, order = TRUE)
patientdata &lt;- data.frame(patientID, age, diabetes, status)
str(patientdata)</code></pre>
<ul>
<li>edit() å¯ä»¥ä¿®æ”¹æ•°æ®</li>
</ul>
</div>
<div id="section-6" class="section level2">
<h2>5.7</h2>
<pre class="r"><code>help.start()
## starting httpd help server ... done
help(package = &quot;vcd&quot;)
library(vcd) 
## Warning: ç¨‹è¾‘åŒ…&#39;vcd&#39;æ˜¯ç”¨Rç‰ˆæœ¬4.0.5 æ¥å»ºé€ çš„
## è½½å…¥éœ€è¦çš„ç¨‹è¾‘åŒ…ï¼šgrid
help(Arthritis) #é˜…è¯»æ•°æ®é›†Arthritisçš„æè¿°
Arthritis 
example(Arthritis)# è¿è¡Œæ•°æ®é›†Arthritisè‡ªå¸¦çš„ç¤ºä¾‹</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-15-1.png" width="672" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r"><code>#q()</code></pre>
</div>
